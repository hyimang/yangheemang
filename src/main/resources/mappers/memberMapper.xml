<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<!-- 
memberMapper.xml: 회원관리에 대한 모든 쿼리를 모아서 관리하는 역할을 
Mybatis sessionFactory클래스에서 쿼리를 생성함
쿼리를 호출할때 사용하는 이름이 namespace값이 됨
이름이 memberMapper안에 쿼리가 여러개 만들게 되는데, 여러개를 구분해서 호출할 때 사용하는 id 
 -->
<mapper namespace="memberMapper">
<!-- 아래 반환값이 MemberVO클래스형이면, select * from 쿼리에서 결과값에 [자동바인딩]됨
단, 멤버변수값이 tbl_member 테이블의 필드명과 일치하게 만들어야 하는 조건.
 -->
<select id="selectMember" resultType="org.edu.vo.MemberVO">
select * from tbl_member
<if test="seach_type !=''">
where
</if>
</select>
<insert id="insertMember">
INSERT INTO tbl_member (
	user_id, 
	user_pw, 
	user_name, 
	email, 
	point, 
	enabled, 
	levels, 
	reg_date
	) VALUES (
	#{user_id}, 
	#{user_pw}, 
	#{user_name}, 
	#{email}, 
	#{point}, 
	#{enabled}, 
	#{levels}, 
	now()
)

</insert>
<!-- jsp에서 변수표현 EL표기법 ${변수명}, 마이바티스에서는 변수표현을 #{변수명} -->
<!-- 마이바티스의 장점, 쿼리안쪽에 조건을 달 수 가 있습니다. -->
<update id="updateMember">
UPDATE tbl_member 
SET 
    user_name = #{user_name},
    <if test="user_pw !=''"><!-- !=not, 유저패스워드가 공백이 아닐때 -->
    user_pw = #{user_pw},
    </if>
    email = #{email},
    point = #{point},
    enabled = #{enabled},
    levels = #{levels},
    update_date = now()
WHERE
    user_id = #{user_id};
</update>

<delete id="deleteMember">
DELETE FROM tbl_member WHERE user_id=#{user_id}
</delete>

<select id="readMember" resultType="org.edu.vo.MemberVO">
SELECT * FROM tbl_member WHERE user_id=#{user_id}
</select>

</mapper>
